# üöÄ –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –ø–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—é

## üìã –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

- Python 3.8+
- –û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å Supabase
- Telegram –±–æ—Ç (—Å—Ç–≤–æ—Ä–µ–Ω–∏–π —á–µ—Ä–µ–∑ @BotFather)

## üîß –ö—Ä–æ–∫ 1: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Supabase

### 1.1 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ [supabase.com](https://supabase.com)
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –ø—Ä–æ–µ–∫—Ç
3. –ó–∞—á–µ–∫–∞–π—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### 1.2 –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤
1. –í Dashboard –ø–µ—Ä–µ–π–¥—ñ—Ç—å –≤ Settings -> API
2. –°–∫–æ–ø—ñ—é–π—Ç–µ:
   - **Project URL** (–ø–æ–ª–µ `Project URL`)
   - **anon public** –∫–ª—é—á (–ø–æ–ª–µ `anon public`)

### 1.3 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ SQL Editor
2. –í–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π SQL –∫–æ–¥:

```sql
CREATE TABLE IF NOT EXISTS survey_responses (
    id SERIAL PRIMARY KEY,
    user_id BIGINT NOT NULL,
    username TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    answers JSONB NOT NULL
);

CREATE INDEX IF NOT EXISTS idx_survey_responses_user_id ON survey_responses(user_id);
CREATE INDEX IF NOT EXISTS idx_survey_responses_created_at ON survey_responses(created_at);
```

## ü§ñ –ö—Ä–æ–∫ 2: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Telegram –±–æ—Ç–∞

### 2.1 –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞
1. –ù–∞–ø–∏—à—ñ—Ç—å [@BotFather](https://t.me/botfather) –≤ Telegram
2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –í–∫–∞–∂—ñ—Ç—å –Ω–∞–∑–≤—É –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "Survey Bot")
4. –í–∫–∞–∂—ñ—Ç—å username –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "my_survey_bot")
5. –°–∫–æ–ø—ñ—é–π—Ç–µ –æ—Ç—Ä–∏–º–∞–Ω–∏–π —Ç–æ–∫–µ–Ω

### 2.2 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–æ—Ç–∞
1. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –æ–ø–∏—Å –±–æ—Ç–∞: `/setdescription`
2. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –±–æ—Ç–∞: `/setabouttext`
3. –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –∫–æ–º–∞–Ω–¥–∏: `/setcommands`

## üíª –ö—Ä–æ–∫ 3: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É

### 3.1 –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
```bash
# –ö–ª–æ–Ω—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç (—è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ git)
git clone <repository-url>
cd Chat_bot_M_v1

# –°—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
python3 -m venv venv

# –ê–∫—Ç–∏–≤—É–π—Ç–µ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
source venv/bin/activate  # Linux/Mac
# –∞–±–æ
venv\Scripts\activate     # Windows

# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install -r requirements.txt
```

### 3.2 –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É:

```env
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_KEY=your-anon-key-here
TELEGRAM_TOKEN=your-bot-token-here
```

## üöÄ –ö—Ä–æ–∫ 4: –ó–∞–ø—É—Å–∫

### 4.1 –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
python setup_database.py

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –±–æ—Ç–∞
python bot.py
```

### 4.2 –í–∏—Ä–æ–±–Ω–∏—á–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

#### –í–∞—Ä—ñ–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä
```bash
# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –±–æ—Ç–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ
nohup python bot.py > bot.log 2>&1 &
```

#### –í–∞—Ä—ñ–∞–Ω—Ç 2: Docker
–°—Ç–≤–æ—Ä—ñ—Ç—å `Dockerfile`:

```dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

CMD ["python", "bot.py"]
```

```bash
# –ó–±—ñ—Ä–∫–∞ —Ç–∞ –∑–∞–ø—É—Å–∫
docker build -t survey-bot .
docker run -d --name survey-bot --env-file .env survey-bot
```

#### –í–∞—Ä—ñ–∞–Ω—Ç 3: –•–º–∞—Ä–Ω—ñ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

**Heroku:**
```bash
# –°—Ç–≤–æ—Ä—ñ—Ç—å Procfile
echo "worker: python bot.py" > Procfile

# –†–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å
heroku create your-bot-name
heroku config:set SUPABASE_URL=your-url
heroku config:set SUPABASE_KEY=your-key
heroku config:set TELEGRAM_TOKEN=your-token
git push heroku main
```

**Railway:**
1. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
2. –î–æ–¥–∞–π—Ç–µ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
3. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–≥–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç

**DigitalOcean App Platform:**
1. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
3. –í–∏–±–µ—Ä—ñ—Ç—å Python runtime

## üìä –ö—Ä–æ–∫ 5: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –∞–Ω–∞–ª—ñ–∑

### 5.1 –ü–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
```bash
# –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∞–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö
python analyze_data.py
```

### 5.2 Supabase Dashboard
- –ü–µ—Ä–µ–≥–ª—è–¥–∞–π—Ç–µ –¥–∞–Ω—ñ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- –°—Ç–≤–æ—Ä—é–π—Ç–µ –≤–ª–∞—Å–Ω—ñ –∑–∞–ø–∏—Ç–∏
- –ï–∫—Å–ø–æ—Ä—Ç—É–π—Ç–µ –¥–∞–Ω—ñ

### 5.3 –õ–æ–≥–∏
```bash
# –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
tail -f bot.log
```

## üîí –ë–µ–∑–ø–µ–∫–∞

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:
1. **–ù—ñ–∫–æ–ª–∏ –Ω–µ –∫–æ–º—ñ—Ç—å—Ç–µ** —Ñ–∞–π–ª `.env` –≤ git
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **—Å–∏–ª—å–Ω—ñ –ø–∞—Ä–æ–ª—ñ** –¥–ª—è Supabase
3. –û–±–º–µ–∂—Ç–µ **–¥–æ—Å—Ç—É–ø –¥–æ API –∫–ª—é—á—ñ–≤**
4. –†–µ–≥—É–ª—è—Ä–Ω–æ **–æ–Ω–æ–≤–ª—é–π—Ç–µ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ**
5. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **HTTPS** –¥–ª—è –≤—Å—ñ—Ö –∑'—î–¥–Ω–∞–Ω—å

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è RLS (Row Level Security):
```sql
-- –í–∫–ª—é—á—ñ—Ç—å RLS –¥–ª—è —Ç–∞–±–ª–∏—Ü—ñ
ALTER TABLE survey_responses ENABLE ROW LEVEL SECURITY;

-- –°—Ç–≤–æ—Ä—ñ—Ç—å –ø–æ–ª—ñ—Ç–∏–∫—É (–∑–∞ –ø–æ—Ç—Ä–µ–±–∏)
CREATE POLICY "Users can view their own responses" ON survey_responses
    FOR SELECT USING (auth.uid()::text = user_id::text);
```

## üêõ –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ü–æ—à–∏—Ä–µ–Ω—ñ –ø–æ–º–∏–ª–∫–∏:

**1. "supabase_url is required"**
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å SUPABASE_URL –≤ .env
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ñ–∞–π–ª .env –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É

**2. "Invalid token"**
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å TELEGRAM_TOKEN
- –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –±–æ—Ç –Ω–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π

**3. "Table does not exist"**
- –í–∏–∫–æ–Ω–∞–π—Ç–µ SQL –∫–æ–¥ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

**4. "Connection timeout"**
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–∑'—î–¥–Ω–∞–Ω–Ω—è
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ñ–∞–π—Ä–≤–æ–ª—É

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ —É –≤–∞—Å –≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏:

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏: `tail -f bot.log`
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤ —Ä–µ–∂–∏–º—ñ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è: `python -u bot.py`
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ Supabase: `python setup_database.py`
4. –°—Ç–≤–æ—Ä—ñ—Ç—å issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º –æ–ø–∏—Å–æ–º –ø—Ä–æ–±–ª–µ–º–∏

## üîÑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è

–î–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –±–æ—Ç–∞:

```bash
# –û—Ç—Ä–∏–º–∞–π—Ç–µ –æ—Å—Ç–∞–Ω–Ω—ñ –∑–º—ñ–Ω–∏
git pull origin main

# –û–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install -r requirements.txt

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å –±–æ—Ç–∞
pkill -f bot.py
python bot.py
```
